

# 1. 元素偏移量 offset 系列

## 1.1 offset 概述

`offset` 翻译过来就是偏移量， 我们使用 offset 系列相关属性可以动态的得到`该元素的位置（偏移）`、`大小`等。

- 获得 **元素距离** 带有 **定位父元素** 的位置
- 获得元素**自身的大小**（宽度高度）
- 注意： 返回的数值都**不带单位**

offset 系列常用属性：

- ![image-20220108231301552](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220108231301552.png)

- ![image-20220109163100042](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220109163100042.png)

- ```html
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <title>Document</title>
      <style>
          * {
              margin: 0;
              padding: 0;
          }
          
          .father {
              /* position: relative; */
              width: 200px;
              height: 200px;
              background-color: pink;
              margin: 150px;
          }
          
          .son {
              width: 100px;
              height: 100px;
              background-color: purple;
              margin-left: 45px;
          }
          
          .w {
              height: 200px;
              background-color: skyblue;
              margin: 0 auto 200px;
              padding: 10px;
              border: 15px solid red;
          }
      </style>
  </head>
  
  <body>
      <div class="father">
          <div class="son"></div>
      </div>
      <div class="w"></div>
      
      <script>
          // offset 系列
          var father = document.querySelector('.father');
          var son = document.querySelector('.son');
          
          // 1.可以得到元素的偏移 位置 返回的不带单位的数值  
          console.log(father.offsetTop);
          console.log(father.offsetLeft);
          
          // 它以带有定位的父亲为准（150px），如果么有父亲或者父亲没有定位，则以 body 自身为准（195px）
          console.log(son.offsetLeft);
          
          // 获取 w 元素
          var w = document.querySelector('.w');
          
          // 2.可以得到元素的大小，宽度和高度，是包含 padding + border + width 
          console.log(w.offsetWidth);
          console.log(w.offsetHeight);
          
          // 3. 返回带有定位的父亲 否则返回的是body
          console.log(son.offsetParent); // 返回带有【定位】的父亲, 否则返回的是body
          console.log(son.parentNode); // 返回父亲, 是最近一级的父亲, 亲爸爸; 不管父亲有没有定位
      </script>
  </body>
  ```

- ![image-20220108233739665](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220108233739665.png)

## 1.2 offset 与 style 区别

- ![image-20220109162334050](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220109162334050.png)
- offset 只读属性，不可改变
- style 可读写，可赋值

### # 案例：获取鼠标在盒子内的坐标

① 我们在盒子内点击，想要得到鼠标距离盒子左右的距离。
② 首先得到鼠标在页面中的坐标（`e.pageX`, `e.pageY`）
③ 其次得到盒子在页面中的距离 ( `box.offsetLeft`, `box.offsetTop`)
④ 用鼠标距离页面的坐标减去盒子在页面中的距离，得到 鼠标在盒子内的坐标
⑤ 如果想要移动一下鼠标，就要获取最新的坐标，使用鼠标移动事件 mousemove

- ```html
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <title>Document</title>
      <style>
          .box {
              width: 300px;
              height: 300px;
              background-color: pink;
              margin: 200px;
          }
      </style>
  </head>
  
  <body>
      <div class="box"></div>
      <script>
          // 我们在盒子内点击， 想要得到鼠标距离盒子左右的距离。
          // 首先得到鼠标在页面中的坐标（ e.pageX, e.pageY）
          // 其次得到盒子在页面中的距离(box.offsetLeft, box.offsetTop)
          // 用鼠标距离页面的坐标减去盒子在页面中的距离， 得到 鼠标在盒子内的坐标
          var box = document.querySelector('.box');
          box.addEventListener('mousemove', function(e) {
              // console.log(e.pageX);
              // console.log(e.pageY);
              // console.log(box.offsetLeft);
              var x = e.pageX - this.offsetLeft;
              var y = e.pageY - this.offsetTop;
              this.innerHTML = 'x坐标是' + x + ' y坐标是' + y;
          })
      </script>
  </body>
  ```

- 

- ![image-20220109163242040](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220109163242040.png)



### # 案例：模态框拖拽

弹出框，我们也称为模态框。
1. 点击弹出层， 会弹出模态框， 并且显示灰色半透明的遮挡层。
2. 点击关闭按钮，可以关闭模态框，并且同时关闭灰色半透明遮挡层。
3. 鼠标放到模态框最上面一行，可以按住鼠标拖拽模态框在页面中移动。
4. 鼠标松开，可以停止拖动模态框移动。

案例分析

① 点击弹出层， 模态框和遮挡层就会显示出来 display:block;
② 点击关闭按钮，模态框和遮挡层就会隐藏起来 display:none;
③ 在页面中拖拽的原理： 鼠标按下并且移动， 之后松开鼠标
④ 触发事件是鼠标按下 mousedown， 鼠标移动mousemove 鼠标松开 mouseup
⑤ 拖拽过程: 鼠标移动过程中，获得最新的值赋值给模态框的left和top值， 这样模态框可以跟着鼠标走了
⑥ 鼠标按下触发的事件源是 最上面一行，就是 id 为 title
⑦ 鼠标的坐标 减去 鼠标在盒子内的坐标， 才是模态框真正的位置。
⑧ 鼠标按下，我们要得到鼠标在盒子的坐标。
⑨ 鼠标移动，就让模态框的坐标 设置为 ： 鼠标坐标 减去盒子坐标即可，注意移动事件写到按下事件里面。
⑩ 鼠标松开，就停止拖拽，就是可以让鼠标移动事件解除

- ```html
  <head lang="en">
      <meta charset="UTF-8">
      <title></title>
      <style>
          .login-header {
              width: 100%;
              text-align: center;
              height: 30px;
              font-size: 24px;
              line-height: 30px;
          }
  
          ul,
          li,
          ol,
          dl,
          dt,
          dd,
          div,
          p,
          span,
          h1,
          h2,
          h3,
          h4,
          h5,
          h6,
          a {
              padding: 0px;
              margin: 0px;
          }
  
          .login {
              display: none;
              width: 512px;
              height: 280px;
              position: fixed;
              border: #ebebeb solid 1px;
              left: 50%;
              top: 50%;
              background: #ffffff;
              box-shadow: 0px 0px 20px #ddd;
              z-index: 9999;
              transform: translate(-50%, -50%);
          }
  
          .login-title {
              width: 100%;
              margin: 10px 0px 0px 0px;
              text-align: center;
              line-height: 40px;
              height: 40px;
              font-size: 18px;
              position: relative;
              cursor: move;
          }
  
          .login-input-content {
              margin-top: 20px;
          }
  
          .login-button {
              width: 50%;
              margin: 30px auto 0px auto;
              line-height: 40px;
              font-size: 14px;
              border: #ebebeb 1px solid;
              text-align: center;
          }
  
          .login-bg {
              display: none;
              width: 100%;
              height: 100%;
              position: fixed;
              top: 0px;
              left: 0px;
              background: rgba(0, 0, 0, .3);
          }
  
          a {
              text-decoration: none;
              color: #000000;
          }
  
          .login-button a {
              display: block;
          }
  
          .login-input input.list-input {
              float: left;
              line-height: 35px;
              height: 35px;
              width: 350px;
              border: #ebebeb 1px solid;
              text-indent: 5px;
          }
  
          .login-input {
              overflow: hidden;
              margin: 0px 0px 20px 0px;
          }
  
          .login-input label {
              float: left;
              width: 90px;
              padding-right: 10px;
              text-align: right;
              line-height: 35px;
              height: 35px;
              font-size: 14px;
          }
  
          .login-title span {
              position: absolute;
              font-size: 12px;
              right: -20px;
              top: -30px;
              background: #ffffff;
              border: #ebebeb solid 1px;
              width: 40px;
              height: 40px;
              border-radius: 20px;
          }
      </style>
  </head>
  
  <body>
      <!-- header -->
      <div class="login-header"><a id="link" href="javascript:;">点击，弹出登录框</a></div>
      <!-- login 模块 -->
      <div id="login" class="login">
          <div id="title" class="login-title">登录会员
              <span><a id="closeBtn" href="javascript:void(0);" class="close-login">关闭</a></span>
          </div>
          <div class="login-input-content">
              <div class="login-input">
                  <label>用户名：</label>
                  <input type="text" placeholder="请输入用户名" name="info[username]" id="username" class="list-input">
              </div>
              <div class="login-input">
                  <label>登录密码：</label>
                  <input type="password" placeholder="请输入登录密码" name="info[password]" id="password" class="list-input">
              </div>
          </div>
          <div id="loginBtn" class="login-button"><a href="javascript:void(0);" id="login-button-submit">登录会员</a></div>
      </div>
      <!-- 遮盖层 -->
      <div id="bg" class="login-bg"></div>
  
  
      <script>
          // 1. 获取元素
          var login = document.querySelector('.login');
          var mask = document.querySelector('.login-bg');
          var link = document.querySelector('#link');
          var closeBtn = document.querySelector('#closeBtn');
          var title = document.querySelector('#title');
          // 2. 点击弹出层这个链接 link  让mask 和login 显示出来
          link.addEventListener('click', function() {
              mask.style.display = 'block';
              login.style.display = 'block';
          })
          // 3. 点击 closeBtn 就隐藏 mask 和 login 
          closeBtn.addEventListener('click', function() {
              mask.style.display = 'none';
              login.style.display = 'none';
          })
          // 4. 开始拖拽
          // (1) 当我们鼠标按下， 就获得鼠标在盒子内的坐标
          title.addEventListener('mousedown', function(e) {
              // 鼠标到盒子边框的距离：不变
              var x = e.pageX - login.offsetLeft;
              var y = e.pageY - login.offsetTop;
              // (2) 鼠标移动的时候，把鼠标在页面中的坐标，减去 鼠标在盒子内的坐标就是模态框的left和top值
              document.addEventListener('mousemove', move)
  
              function move(e) {
                  login.style.left = e.pageX - x + 'px';
                  login.style.top = e.pageY - y + 'px';
              }
              // (3) 鼠标弹起，就让鼠标移动事件移除
              document.addEventListener('mouseup', function() {
                  document.removeEventListener('mousemove', move);
              })
          })
      </script>
  </body>
  ```

- ![image-20220109172211396](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20220109172211396.png)