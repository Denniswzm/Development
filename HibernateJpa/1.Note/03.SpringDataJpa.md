# 03.SpringDataJpa

## 1. Feature

- 提供基于 JPA 标准操作数据库的简化方案
- 只需要定义接口，并继承 Spring Data JPA 中所提供的接口。不需要编写实现类

## 2. 运行逻辑

- Customer：实体类；需要查询的对象
- Long：主键类型

```java
public interface CustomerRepository extends JpaRepository<Customer, Long> {
    List<Customer> findByLastName(String lastName);

    Customer findById(long id);
}
```

![image-20210831205917747](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831205917747.png)

- 注入 SimpleJpaRepository 的代理对象 
  - ![image-20210831210635663](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831210635663.png)

## 3. JpaSpecificationExecutor

- 更多条件查询

## 4. Repository接口

### 4.1 基于方法名称命名规则查询

- 规则：**findBy (关键字) + 属性名称（属性名称首字母大写）+ 查询条件（首字母大写）**
  - 判断相等的条件，有三种方式
    1. 什么都不写
    2. Is
    3. Equal
  - Like (`“王%”`)
    - <img src="https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831212258649.png" alt="image-20210831212258649" style="zoom: 80%;" />
  - 多条件
    - <img src="https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831212515496.png" alt="image-20210831212515496" style="zoom:80%;" />

### 4.2 基于 @Query 注解查询

#### 4.2.1 通过 JPQL 查询（HQL演变）

- <img src="https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831213849060.png" alt="image-20210831213849060" style="zoom:80%;" />

#### 4.2.2 通过 JPQL 更新

- ![image-20210831214243378](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831214243378.png)

#### 4.2.3 通过 SQL 查询

- ![image-20210831213941396](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831213941396.png)



## 5. CrudRepository 接口

- 查询
  - ![image-20210831215539358](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831215539358.png)
- update
  - 方法一：
    - ![image-20210831215859494](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831215859494.png)
  - 方法二：
    - 持久化状态，会持久化到数据库
    - ![image-20210831220124429](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831220124429.png)
- save
  - ![image-20210831215250680](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831215250680.png)
- delete
  - 先根据 id 查询，再删除
  - ![image-20210831215650331](https://raw.githubusercontent.com/TWDH/Leetcode-From-Zero/pictures/img/image-20210831215650331.png)

















